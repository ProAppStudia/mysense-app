<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/tabs/filter"></ion-back-button>
    </ion-buttons>
    <ion-title>{{ isDoctorCardView(doctor) ? doctor.fullName : 'Профіль' }}</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">
  <div *ngIf="doctor">
    <div *ngIf="isDoctorCardView(doctor); else errorView" class="psychologist-card profile-page">
      <div class="card-header">
        <img [src]="doctor.avatarUrl || 'assets/img/IMG_1743.jpeg'" alt="Psychologist" class="psychologist-avatar">
        <div class="header-info">
          <div class="online-offline-status">
            <span *ngIf="doctor.online" class="status-item online">
              <ion-icon src="assets/icon/onlain.svg"></ion-icon>
              Онлайн
            </span>
            <span *ngIf="doctor.inPerson" class="status-item offline">
              <ion-icon src="assets/icon/ochno.svg"></ion-icon>
              Очно
            </span>
          </div>
          <p *ngIf="doctor.city" class="location">{{ doctor.city }}</p>
          <h3 class="psychologist-name">{{ doctor.fullName }}</h3>
          <p *ngIf="doctor.verified" class="verified-specialist">
            <ion-icon src="assets/icon/verified.svg"></ion-icon>
            Перевірений фахівець
          </p>
        </div>
      </div>
      <p *ngIf="doctor.specialization" class="specialization">{{ doctor.specialization }}</p>
      <div class="stats">
        <span *ngIf="doctor.experienceYears" class="stat-item">
          <ion-icon src="assets/icon/praktika.svg"></ion-icon>
          {{ doctor.experienceYears }} років практики
        </span>
        <span *ngIf="doctor.sessionsCount" class="stat-item">
          <ion-icon src="assets/icon/session.svg"></ion-icon>
          {{ doctor.sessionsCount }}+ сесій
        </span>
      </div>
      <div class="feedback-and-intro">
        <span *ngIf="doctor.feedbackCount" class="feedback-item">
          <ion-icon src="assets/icon/otzyv.svg"></ion-icon>
          {{ doctor.feedbackCount }} відгуки
        </span>
        <span *ngIf="doctor.introMinutes" class="intro-item">
          <ion-icon src="assets/icon/hello.svg"></ion-icon>
          Знайомство {{ doctor.introMinutes }} хв
        </span>
      </div>
      <div class="pricing">
        <div *ngIf="doctor.priceIndividual" class="price-item">
          <p style="font-size: 14px; color: #9895a6; font-weight: 400;">Індивідуальна</p>
          <p class="price-value" style="color: #2f264d; font-size: 20px; font-weight: 500;">{{ doctor.priceIndividual }} <span class="currency" style="font-size: 14px; color: #9895a6; font-weight: 400;">грн.</span></p>
        </div>
        <div *ngIf="doctor.priceFamily" class="price-item">
          <p style="font-size: 14px; color: #9895a6; font-weight: 400;">Сімейна</p>
          <p class="price-value" style="color: #2f264d; font-size: 20px; font-weight: 500;">{{ doctor.priceFamily }} <span class="currency" style="font-size: 14px; color: #9895a6; font-weight: 400;">грн.</span></p>
        </div>
      </div>

      <div *ngIf="doctor.videoAppealUrl" class="video-container">
        <video controls [src]="doctor.videoAppealUrl" width="100%"></video>
      </div>

      <ion-button *ngIf="doctor.introMinutes" class="intro-button" expand="block" fill="outline">
        <ion-icon src="assets/icon/hello.svg" slot="start"></ion-icon>
        Домовитись про знайомство {{ doctor.introMinutes }} хв
      </ion-button>

      <div class="info-block">
        <h4 class="info-title">
          <ion-icon src="assets/icon/zkem.svg"></ion-icon>
          З ким я працюю
        </h4>
        <ul>
          <li *ngFor="let type of doctor.workWithTypes">{{ type }}</li>
        </ul>

        <h4 class="info-title">
          <ion-icon src="assets/icon/star.svg"></ion-icon>
          Працюю з:
        </h4>
        <ul>
          <li *ngIf="doctor.worksWithMilitary">Військовими</li>
          <li *ngIf="doctor.worksWithLgbt">ЛГБТКІ+</li>
        </ul>

        <h4 class="info-title">
          <ion-icon src="assets/icon/lang.svg"></ion-icon>
          Мова спілкування:
        </h4>
        <ul>
          <li *ngFor="let lang of doctor.languages">{{ lang }}</li>
        </ul>
      </div>

      <div class="info-block about-me">
        <h4 class="info-title">Про мене</h4>
        <div class="description" [class.expanded]="isDescriptionExpanded">
          <p>{{ doctor.description }}</p>
        </div>
        <button (click)="toggleDescription()" class="show-more-button">
          {{ isDescriptionExpanded ? 'Згорнути' : 'Показати більше' }}
        </button>
      </div>

      <div class="info-block">
        <h4 class="info-title">Я працюю з:</h4>
        <ul>
          <li *ngFor="let item of doctor.worksWith">{{ item }}</li>
        </ul>
      </div>

      <div class="info-block">
        <h4 class="info-title">Я не працюю з:</h4>
        <ul>
          <li *ngFor="let item of doctor.doNotWorkWith" class="not-work-with">{{ item }}</li>
        </ul>
      </div>
    </div>
    <ng-template #errorView>
      <p>Не вдалося завантажити профіль.</p>
    </ng-template>
  </div>
</ion-content>

<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/tabs/tab1" icon="assets/icon/arrow-left-color.svg" text=""></ion-back-button>
    </ion-buttons>
    <ion-title>Мої сесії</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">
  <div class="session-tabs">
    <button type="button" class="session-tab" [class.active]="selectedSegment === 'planned'" (click)="setSegment('planned')">
      Заплановані
    </button>
    <button type="button" class="session-tab" [class.active]="selectedSegment === 'past'" (click)="setSegment('past')">
      Минулі
    </button>
    <button type="button" class="session-tab" [class.active]="selectedSegment === 'archive'" (click)="setSegment('archive')">
      Архів
    </button>
  </div>

  
    <div *ngIf="filteredSessions.length > 0; else noSessions" class="sessions-list">
      <div *ngFor="let session of filteredSessions; let i = index" class="session-card">
        <div class="session-info">
          <div class="session-status-row">
            <div class="session-status-chip" [ngClass]="statusColorClass(session)">
              {{ session.status }}
            </div>
            <ion-button
              *ngIf="showActions(session) && !isPaidSession(session)"
              fill="clear"
              class="session-pay-inline"
              (click)="isDoctor ? copyPaymentLink(session) : paySession(session)"
              [disabled]="actionLoading"
            >
              {{ isDoctor ? 'Посилання на оплату' : 'Оплатити' }}
              <ion-icon slot="end" [name]="isDoctor ? 'copy-outline' : 'wallet-outline'"></ion-icon>
            </ion-button>
          </div>
          <div class="session-date-time">
            <ion-icon name="calendar-outline"></ion-icon>
            <span>{{ formatSessionTime(session.time_range).date }} о {{ formatSessionTime(session.time_range).time }}</span>
          </div>
          <div class="doctor-info">
            <img [src]="session.doctor_image" alt="{{ session.doctor_name }}">
            <span>{{ session.doctor_name }}</span>
          </div>
        </div>
        <div class="session-actions" *ngIf="showActions(session)">
          <ion-button fill="clear" class="reschedule-button" (click)="rescheduleSession(session)" [disabled]="actionLoading">
            Перенести
            <ion-icon slot="end" name="arrow-forward-outline"></ion-icon>
          </ion-button>
          <ion-button fill="clear" class="cancel-button" (click)="cancelSession(session.id)" [disabled]="actionLoading">
            Відмінити
            <ion-icon slot="end" name="close-outline"></ion-icon>
          </ion-button>
        </div>
      </div>
    </div>
  

  <ng-template #noSessions>
    <div class="no-sessions">
      <p>{{ emptyStateText() }}</p>
    </div>
  </ng-template>
</ion-content>
